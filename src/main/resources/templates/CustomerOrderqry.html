<!DOCTYPE HTML>

<html>

<head>
	<title>客戶消費紀錄</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" th:href="@{/assets/css/main.css}" />
	<link rel="stylesheet" th:href="@{/form/FormBold.css}" />
	
	<script th:src="@{/js/vue.min.js}"></script>
    <script th:src="@{/js/axios.min.js}"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<script th:inline="javascript">
		var queryURL = /*[[${query}]]*/ ''
	</script>
	<style>
		p.contact-company{
			font-size:1.6em;
		}
		.contact-company{
			font-size:1.3em;
		}
	</style>
</head>

<body class="is-preload">
	
	<!-- Wrapper -->
	<div id="wrapper">

		<!-- Main -->
		<div id="main">
			<div class="inner">
				<div class="formbold-main-wrapper">
					<div class="formbold-form-wrapper" id="myForm">
						<div>客戶查詢</div>
                        <div>
                            <!--使用Vue 指令 借助v-model 雙向two-ways attribute-->
                            <input type="text" v-model:value="name"/>
                            <button v-on:click="queryHandler" style="color:blueviolet;font-size: 18px;">查詢</button>
                        </div>
                        <fieldset v-show="isShow">
                            <legend>{{name}} 客戶清單</legend>
                            <div>記錄數:{{result.length}}</div>
                            <table class="tableStyle">
                                <thead>
                                    <tr>
                                        <td>日期</td>
                                        <td>服務內容</td>
                                        <td>售價</td>
                                           
                                    </tr>
                                </thead>
                                <tbody id="tbody">
                                    <tr v-for="item in result">
                                        
                                        <td>{{item.createDate}}</td>
                                        <td>{{item.serviceItem}}</td>
                                        <td>{{item.salePrice}}</td>
                                    </tr>    
                                </tbody>
                            </table>
                        </fieldset>
					</div>
				</div>

			</div>
			
		</div>
		
		  

		<!-- Sidebar -->
		<div id="sidebar">
			<div class="inner">

				<!-- Search -->
				<section id="search" class="alt">
					<!-- 未來設計:跳轉目標選單頁面 -->
					<form method="post" action="">
						<input type="text" name="query" id="query" placeholder="Search" />
					</form>
				</section>

				<!-- Menu -->
				<nav id="menu">
					<header class="major">
						<h2>Menu</h2>
					</header>
					<ul>
						<!-- <li><a th:href="@{/home}">主畫面</a></li> -->
						<li>
							<span class="opener">銷售建檔系統</span>
							<ul>
								<!-- <li><a th:href="@{/}">客戶基本資料建檔</a></li> -->
								<li><a th:href="@{../Microblading/OrderForm}">紋繡銷售建檔</a></li>
								<!-- <li><a th:href="@{/}">護膚銷售建檔</a></li> -->
							</ul>
						</li>
						<li>
							<span class="opener">業績查詢系統</span>
							<ul>
								<li><a th:href="@{../Customer/Order}">客戶消費紀錄</a></li>
								<li><a th:href="@{/}">本月紋繡業績查詢</a></li>
								<li><a th:href="@{/}">本月護膚業績查詢</a></li>
							</ul>
						</li>
						<li>
							<span class="opener">進貨成本庫存系統</span>
							<ul>
								<!-- <li><a th:href="@{/}">商品名建檔</a></li>
								<li><a th:href="@{/}">每次進貨花費建檔</a></li>
								<li><a th:href="@{/}">目前庫存查詢</a></li> -->
							</ul>
						</li>
					</ul>
				</nav>

				

				<!-- Section -->
				<section>
					<header class="major">
						<h2>Get in touch</h2>
					</header>
					<p class="contact-company">有任何問題歡迎來電諮詢</p>
					<ul class="contact">
						<li class="icon solid fa-home contact-company">DavidLan</li>
						<li class="icon solid fa-phone contact-company">0975-787-062</li>
					</ul>
				</section>

				<!-- Footer -->
				<footer id="footer">
					<p class="copyright">&copy; SannyStudio All rights reserved. </p>
				</footer>

			</div>
		</div>

	</div>

	<!-- Scripts -->
	

	<script>
        //1.建構一個Vue Instance物件
        var app=new Vue(
			{   
                data:{
                    name:name,
                    //呼喚後端服務回應的JSON Array
                    result:[], //查詢結果
                    message:'',
                    isShow:false
                      //挑選的相對列物件
                },
				methods:
				{
            		queryHandler:function(){
                        //reset
                        this.isShow=false;
                        this.message='';
                        let urlString=queryURL+this.name;
                        //Request Method-GET
                        axios.get(urlString)
                        //http status 2xx 
                        .then(res => {
                            console.log(res)
                            //將回呼查詢結果
                            this.result=res.data;
                            this.isShow=true;
                        })
                        //4xx or 5xx
                        .catch(err => {
                            console.log(err); 
                            //判斷
                            console.log(err.response);
                            if(err.response.status==400){
                                this.message=err.response.data.msg;
                            }
                        })
                        
                    }
					
					
                }
                
			});
		app.$mount('#myForm');
			
	</script>
	<script th:src="@{/assets/js/jquery.min.js}"></script>
	<script th:src="@{/assets/js/browser.min.js}"></script>
	<script th:src="@{/assets/js/breakpoints.min.js}"></script>
	<script th:src="@{/assets/js/util.js}"></script>
	<script th:src="@{/assets/js/main.js}"></script>
	<script>
		
		 
		function infor() 
		{
			alert("123");
		}

		function send(event)
		{
			var name = document.getElementById("name").value;
			var sex = document.getElementById("sex").value;
			var phone = document.getElementById("phone").value;
			var serviceItem = document.getElementById("serviceItem").value;
			var salePrice = document.getElementById("salePrice").value;
			salePrice = Number(salePrice); //去掉字符串前面的0
			var createDate = document.getElementById("createDate").value;
			var memo = document.getElementById("memo").value;
			
			//防止輸入空白 
			if(name.length==0){alert("請輸入客戶姓名！"); event.preventDefault();return false;}
			else if(sex.length==0){alert("請輸入性別！");event.preventDefault();return false;}
			else if(phone.length==0||phone.length>10){alert("請輸入10位數字以下電話號碼！");event.preventDefault();return false;}
			else if(serviceItem.length==0){alert("請輸入服務項目！");event.preventDefault();return false;}
			else if(salePrice.length==0){alert("請輸入此次服務銷售金額！");event.preventDefault();return false;}
			else if(createDate.length==0){alert("請輸入施作日期！");event.preventDefault();return false;}
			
			//防止亂輸入
			if(phone.length>10)alert("電話號碼不可超過10碼！");
			if(memo.length>100)alert("備註不可超過一百字！");
			//alert(result);
			//console.log(e);
		}
		
		//window.onload = function(){
		//	alert(result);
		//}
		
		
	</script>
</body>

</html>